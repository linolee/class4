<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.sist.user.mapper.userMypage_mapper">
<resultMap type="kr.co.sist.user.domain.ClassList" id="classListResult">
	<result column="lcode" property="lcode"/>
	<result column="status" property="status"/>
	<result column="lname" property="lname"/>
	<result column="start_date" property="startDate"/>
	<result column="end_date" property="endDate"/>
	<result column="num" property="num"/>
	<result column="teacher_name" property="teacherName"/>
</resultMap>
<select id="classList" parameterType="kr.co.sist.user.vo.ListVO" resultMap="classListResult">
	select s.lcode, s.status, l.lname, to_char(l.start_date, 'yyyy-mm-dd') start_date, 
			to_char(l.end_date, 'yyyy-mm-dd') end_date,num,  l.teacher_name
	from students s, lesson l,
			(select max(rownum) num
			from students
			where lcode=#{lcode}) n
	where s.lcode=#{lcode} and l.lcode=#{lcode} and s.client_id=#{clientId}
</select>

<select id="reviewStatus" parameterType="kr.co.sist.user.vo.ListVO" resultType="String">
	select		subject
	from		review
	where	client_ID=#{clientId} and lcode=#{lcode}
</select>

<select id="insertJjim" parameterType="kr.co.sist.user.vo.ListVO" resultType="boolean">
	insert into lesson_like values(#{clientId}, #{lcode})	
</select>

<select id="deleteJjim" parameterType="kr.co.sist.user.vo.ListVO" resultType="boolean">
	DELETE  FROM  LESSON_LIKE
	WHERE lcode=#{lcode} and client_ID=#{clientId}
</select>

<select id="statusClassList" parameterType="kr.co.sist.user.vo.StatusListVO" resultMap="classListResult">
	select s.status, l.lname, to_char(l.start_date, 'yyyy-mm-dd') start_date, 
			to_char(l.end_date, 'yyyy-mm-dd') end_date,num,  l.teacher_name
	from students s, lesson l,
			(select max(rownum) num
			from students
			where lcode=#{lcode}) n
	where s.lcode=#{lcode} and l.lcode=#{lcode} and s.client_id=#{clientId} and s.status=#{pageStatus}
</select>

<select id="jjimStatus" parameterType="kr.co.sist.user.vo.ListVO" resultType="String">
	select		lcode
	from		lesson_like
	where	client_id=#{clientId} and lcode=#{lcode}
</select>

<select id="lcodeList" parameterType="String" resultType="String">
	select lcode
	from students
	where client_id=#{clientId}
</select>
<select id="listTotalCnt" parameterType="String" resultType="int">
 	select count(lcode) cnt
	from students
	where client_id=#{clientId}
</select>

<select id="statusCnt" parameterType="kr.co.sist.user.vo.StatusCntVO" resultType="int">
 	select count(lcode) cnt
	from students
	where client_id=#{clientId} and status=#{status}
</select>
</mapper>