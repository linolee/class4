<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.sist.user.detailC">

<resultMap type="kr.co.sist.user.domain.Summary" id="summary">
	<result column="banner_img" property="banner_img"/>
	<result column="lname" property="lname"/>
	<result column="lintro" property="lintro"/>
	<result column="teacher_name" property="teacher_name"/>
	<result column="address" property="address"/>
	<result column="max_member" property="max_member"/>
	<result column="class_time" property="class_time"/>
	<result column="img" property="img"/>
</resultMap>
<select id="selectSummary" resultMap="summary" parameterType="String">
	select l.banner_img,l.lname,l.lintro,l.teacher_name,substr(l.address,instr(l.address,'ì‹œ')+2,3) address,l.max_member,l.end_time-l.start_time class_time,t.img
	from lesson l ,teacher t
	where  t.teacher_name=l.teacher_name and lcode = #{lcode}
</select>

<resultMap type="kr.co.sist.user.domain.Star" id="star">
	<result column="starAvg" property="starAvg"/>
	<result column="starCount" property="starCount"/>
</resultMap>
<select id="selectStar" resultMap="star" parameterType="String">
	select avg(score) starAvg ,count(score) starCount
	from review
	where lcode = #{lcode}
</select>

<select id="selectCareerList" resultType="String" parameterType="String"> 
	select c.career
	from career c
	where c.teacher_name=
	(select t.TEACHER_NAME
	from lesson l inner join teacher t
	on t.teacher_name=l.TEACHER_NAME
	where lcode= #{lcode})
</select>

<resultMap type="kr.co.sist.domain.DetailContents" id="detailC">
	<result column="dcontents" property="dcontents"/>
	<result column="curriculum" property="curriculum"/>
	<result column="others" property="others"/>
	<result column="address" property="address"/>
</resultMap>
<select id="selectContents" resultMap="detailC" parameterType="String">
	select contents dcontents,curriculum,others,address
	from lesson
	where lcode=#{lcode}
</select>

<select id="selectOpt" resultType="String" parameterType="String">
	select opt
	from l_OPT
	where lcode=#{lcode}
</select>

<select id="selectNoOpt" resultType="String">
	select opt
	from opt;
</select>

<resultMap type="kr.co.sist.user.domain.ReviewDomain" id="Review">
	<result column="client_id" property="client_id"/>
	<result column="subject" property="subject"/>
	<result column="contents" property="contents"/>
	<result column="score" property="score"/>
	<result column="r_date" property="r_date"/>
</resultMap>
<select id="selectReviewList" resultMap="Review" parameterType="String">
	select   client_id, subject, contents, score, r_date
	from review
	where lcode = #{lcode}
</select>

<resultMap type="kr.co.sist.user.domain.QnA" id="qna">
	<result column="qcode" property="qcode"/>
	<result column="client_id" property="client_id"/>
	<result column="subject" property="subject"/>
	<result column="q_date" property="q_date"/>
	<result column="status" property="status"/>
</resultMap>
<select id="selectQnaList" resultMap="qna" parameterType="String">
	select qcode,client_id, subject,q_date,status
	from lesson_qna
	where lcode=#{lcode}
</select>

<!--
select Main_img, Lname,lcode, teacher_name
from lesson
where teacher_name=(select teacher_name from lesson where lcode='2')
and lcode!='2';
  -->

</mapper>